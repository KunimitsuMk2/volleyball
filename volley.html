<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Éê„É¨„Éº„Éú„Éº„É´ „Éï„Ç©„Éº„É°„Éº„Ç∑„Éß„É≥Ëß£Ë™¨ÁîªÂÉè</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            background: #f0f0f0;
        }

        .slide {
            width: 375px;
            height: 812px;
            background: white;
            margin: 20px auto;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            padding: 30px;
            box-sizing: border-box;
            position: relative;
            overflow: hidden;
        }

        .slide::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, #ff6b6b, #ffa500, #43e97b, #4facfe);
        }

        .slide-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .slide-number {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin: 0 auto 15px;
            font-size: 18px;
        }

        .slide-title {
            font-size: 22px;
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
            line-height: 1.3;
        }

        .slide-subtitle {
            font-size: 14px;
            color: #666;
            margin-bottom: 15px;
        }

        /* Ëá™Èô£„Ç≥„Éº„ÉàÔºàÁ∏¶Âêë„Åç„ÄÅ„Éç„ÉÉ„Éà‰∏äÈÉ®Ôºâ */
        .court {
            width: 260px;
            height: 280px;
            border: 3px solid #333;
            position: relative;
            background: linear-gradient(to bottom, #e8f5e8, #d4e5d4);
            margin: 15px auto;
            border-radius: 8px;
            border-top: 6px solid #333;
            /* „Éç„ÉÉ„Éà */
        }

        .net-label {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 4px 12px;
            border-radius: 5px;
            font-size: 12px;
            font-weight: bold;
        }

        .front-zone {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 40%;
            border-bottom: 2px dashed #999;
        }

        .front-label {
            position: absolute;
            top: 15px;
            right: 10px;
            background: rgba(255, 255, 255, 0.8);
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 10px;
        }

        .back-label {
            position: absolute;
            bottom: 15px;
            right: 10px;
            background: rgba(255, 255, 255, 0.8);
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 10px;
        }

        .player {
            position: absolute;
            width: 55px;
            height: 55px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 11px;
            color: white;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
            transform: translate(-50%, -50%);
            border: 3px solid white;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .player:hover {
            transform: translate(-50%, -50%) scale(1.1);
            z-index: 20;
        }

        .player.male {
            background: linear-gradient(45deg, #4facfe, #00f2fe);
        }

        .player.female {
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
        }

        .player.setter {
            background: linear-gradient(45deg, #43e97b, #38f9d7);
            border: 3px solid #fff;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3), 0 0 0 2px #43e97b;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3), 0 0 0 2px #43e97b, 0 0 0 0 rgba(67, 233, 123, 0.7);
            }

            70% {
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3), 0 0 0 2px #43e97b, 0 0 0 8px rgba(67, 233, 123, 0);
            }

            100% {
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3), 0 0 0 2px #43e97b, 0 0 0 0 rgba(67, 233, 123, 0);
            }
        }

        .position-number {
            position: absolute;
            font-size: 16px;
            font-weight: bold;
            color: #333;
            background: rgba(255, 255, 255, 0.9);
            padding: 3px 8px;
            border-radius: 12px;
            transform: translate(-50%, -50%);
            border: 2px solid #333;
        }

        .explanation {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            border-radius: 12px;
            margin: 12px 0;
            font-size: 13px;
            line-height: 1.5;
        }

        .explanation h3 {
            margin: 0 0 10px 0;
            font-size: 16px;
            text-align: center;
        }

        .key-points {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 10px;
            margin: 12px 0;
            border-left: 4px solid #4facfe;
        }

        .key-points h4 {
            margin: 0 0 8px 0;
            color: #333;
            font-size: 14px;
        }

        .key-points ul {
            margin: 0;
            padding-left: 16px;
        }

        .key-points li {
            margin: 5px 0;
            font-size: 12px;
            line-height: 1.3;
        }

        .legend {
            display: flex;
            justify-content: space-around;
            margin: 15px 0;
            font-size: 11px;
        }

        .legend-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .legend-color {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .male-color {
            background: linear-gradient(45deg, #4facfe, #00f2fe);
        }

        .female-color {
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
        }

        .setter-color {
            background: linear-gradient(45deg, #43e97b, #38f9d7);
        }

        .navigation {
            text-align: center;
            margin: 20px 0;
        }

        .nav-btn {
            background: linear-gradient(45deg, #4facfe, #00f2fe);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            margin: 0 10px;
            cursor: pointer;
            font-weight: bold;
        }

        .nav-btn:hover {
            transform: translateY(-2px);
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Âü∫Êú¨„É´„Éº„É´Áî®„ÅÆ„Çπ„Çø„Ç§„É´ */
        .rule-section {
            background: white;
            border: 2px solid #4facfe;
            border-radius: 10px;
            padding: 12px;
            margin: 12px 0;
        }

        .rule-section h4 {
            color: #4facfe;
            margin: 0 0 8px 0;
            font-size: 14px;
        }
    </style>
</head>

<body>
    <!-- „Çπ„É©„Ç§„Éâ1: ÂàùÊúü„É≠„Éº„ÉÜ„Éº„Ç∑„Éß„É≥ -->
    <div class="slide" id="slide1">
        <div class="slide-header">
            <div class="slide-number">1</div>
            <h2 class="slide-title">üèê ÂàùÊúü„É≠„Éº„ÉÜ„Éº„Ç∑„Éß„É≥</h2>
            <p class="slide-subtitle">Âü∫Êú¨ÈÖçÁΩÆ„Éª„Çπ„Çø„Éº„Éà„Éù„Ç∏„Ç∑„Éß„É≥</p>
        </div>

        <div class="court">
            <div class="net-label">„Éç„ÉÉ„Éà</div>
            <div class="front-zone">
                <div class="front-label">ÂâçË°õ</div>
            </div>
            <div class="back-label">ÂæåË°õ</div>

            <!-- „Éù„Ç∏„Ç∑„Éß„É≥4: „Çµ„Ç§„É§ -->
            <div class="player male" style="left: 20%; top: 25%;">„Çµ„Ç§„É§</div>
            <div class="position-number" style="left: 20%; top: 8%;">‚ë£</div>

            <!-- „Éù„Ç∏„Ç∑„Éß„É≥3: „Åü„Åë„Å°„ÇÉ„Çì -->
            <div class="player setter" style="left: 50%; top: 25%;">„Åü„Åë</div>
            <div class="position-number" style="left: 50%; top: 8%;">‚ë¢</div>

            <!-- „Éù„Ç∏„Ç∑„Éß„É≥2: „Åø„Åè -->
            <div class="player female" style="left: 80%; top: 25%;">„Åø„Åè</div>
            <div class="position-number" style="left: 80%; top: 8%;">‚ë°</div>

            <!-- „Éù„Ç∏„Ç∑„Éß„É≥5: „ÇÜ„Åç -->
            <div class="player female" style="left: 20%; top: 75%;">„ÇÜ„Åç</div>
            <div class="position-number" style="left: 20%; top: 92%;">‚ë§</div>

            <!-- „Éù„Ç∏„Ç∑„Éß„É≥6: „Åè„Å´„Åø„Å§ -->
            <div class="player male" style="left: 50%; top: 75%;">„Åè„Å´</div>
            <div class="position-number" style="left: 50%; top: 92%;">‚ë•</div>

            <!-- „Éù„Ç∏„Ç∑„Éß„É≥1: „Åü„ÅÑ -->
            <div class="player male" style="left: 80%; top: 75%;">„Åü„ÅÑ</div>
            <div class="position-number" style="left: 80%; top: 92%;">‚ë†</div>
        </div>

        <div class="legend">
            <div class="legend-item">
                <div class="legend-color male-color"></div>
                <span>Áî∑ÊÄß</span>
            </div>
            <div class="legend-item">
                <div class="legend-color female-color"></div>
                <span>Â•≥ÊÄß</span>
            </div>
            <div class="legend-item">
                <div class="legend-color setter-color"></div>
                <span>„Çª„ÉÉ„Çø„Éº</span>
            </div>
        </div>

        <div class="explanation">
            <h3>üéØ ÂàùÊúü„É≠„Éº„ÉÜ„Éº„Ç∑„Éß„É≥„ÅÆÁâπÂæ¥</h3>
            <p>„Çª„ÉÉ„Çø„ÉºÔºà„Åü„Åë„Å°„ÇÉ„ÇìÔºâ„ÅåÂâçË°õ‰∏≠Â§Æ„Å´„ÅÑ„Çã„Åü„ÇÅ„ÄÅ<strong>‰∏°„Çµ„Ç§„Éâ„Å∏„ÅÆÈÖçÁêÉ</strong>„ÅåÂèØËÉΩ„ÄÇÂ∑¶„ÅÆ„Çµ„Ç§„É§„ÄÅÂè≥„ÅÆ„Åø„Åè„Å∏„Éê„É©„É≥„ÇπËâØ„ÅèÊîªÊíÉ„ÇíÂ±ïÈñã„Åß„Åç„ÇãÂü∫Êú¨„Éï„Ç©„Éº„É°„Éº„Ç∑„Éß„É≥„ÄÇ</p>
        </div>

        <div class="key-points">
            <h4>üìã Âü∫Êú¨ÂΩπÂâ≤</h4>
            <ul>
                <li><strong>„Çµ„Ç§„É§Ôºà‚ë£ÔºâÔºö</strong>„É¨„Éï„Éà„Ç¢„Çø„ÉÉ„Ç´„Éº„Éª„Éñ„É≠„ÉÉ„ÇØ</li>
                <li><strong>„Åü„Åë„Å°„ÇÉ„ÇìÔºà‚ë¢ÔºâÔºö</strong>„Çª„ÉÉ„Çø„Éº„Éª„Çª„É≥„Çø„Éº„Ç¢„Çø„ÉÉ„ÇØ</li>
                <li><strong>„Åø„ÅèÔºà‚ë°ÔºâÔºö</strong>„É©„Ç§„Éà„Ç¢„Çø„ÉÉ„Ç´„Éº„Éª„Éñ„É≠„ÉÉ„ÇØ</li>
                <li><strong>„ÇÜ„Åç„Éª„Åè„Å´„Åø„Å§„Éª„Åü„ÅÑÔºö</strong>„É¨„Ç∑„Éº„Éñ„Éª„Ç´„Éê„Éº</li>
            </ul>
        </div>

        <div class="rule-section">
            <h4>üîÑ „É≠„Éº„ÉÜ„Éº„Ç∑„Éß„É≥„Å´„Å§„ÅÑ„Å¶</h4>
            <p style="font-size: 12px; line-height: 1.4;">
                „Çµ„Éº„ÉñÊ®©„ÇíÁç≤Âæó„Åó„Åü„Çâ„ÄÅÂÖ®Âì°„ÅåÊôÇË®àÂõû„Çä„Å´1„Å§„Åö„Å§ÁßªÂãï„ÄÇ
                „Åì„ÅÆÂü∫Êú¨ÈÖçÁΩÆ„Åã„Çâ6„Å§„ÅÆ„É≠„Éº„ÉÜ„Éº„Ç∑„Éß„É≥„ÅåÂßã„Åæ„Çä„Åæ„Åô„ÄÇ
            </p>
        </div>
    </div>

    <div class="navigation">
        <button class="nav-btn" onclick="prevSlide()" id="prevBtn">‚óÄ Ââç„Å∏</button>
        <span id="slideCounter">1 / 14</span>
        <button class="nav-btn" onclick="nextSlide()" id="nextBtn">Ê¨°„Å∏ ‚ñ∂</button>
    </div>

    <p style="text-align: center; margin: 20px 0; color: #666; font-size: 13px;">
        üí° ÂêÑ„Çπ„É©„Ç§„Éâ„ÇíÁîªÂÉè„Å®„Åó„Å¶‰øùÂ≠ò„Åó„Å¶LINE„ÅßÂÖ±Êúâ„Åß„Åç„Åæ„Åô<br>
        ÔºàÂè≥„ÇØ„É™„ÉÉ„ÇØ ‚Üí „ÄåÁîªÂÉè„Çí‰øùÂ≠ò„ÄçÔºâ
    </p>

    <script>
        let currentSlide = 1;
        const totalSlides = 15; // „Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„Éñ„Éö„Éº„Ç∏ËøΩÂä†„Åß15Êûö„Å´

        // „ÉÅ„Éº„É†„É°„É≥„Éê„ÉºÊÉÖÂ†±
        const players = {
            '„Çµ„Ç§„É§': { gender: 'male', position: '„Ç¢„Çø„ÉÉ„Ç´„Éº' },
            '„Åü„Åë„Å°„ÇÉ„Çì': { gender: 'female', position: '„Çª„ÉÉ„Çø„Éº', special: true },
            '„Åø„Åè': { gender: 'female', position: '„Ç¢„Çø„ÉÉ„Ç´„Éº' },
            '„ÇÜ„Åç': { gender: 'female', position: '„Ç¢„Çø„ÉÉ„Ç´„Éº' },
            '„Åè„Å´„Åø„Å§': { gender: 'male', position: '„Ç¢„Çø„ÉÉ„Ç´„Éº' },
            '„Åü„ÅÑ': { gender: 'male', position: '„É™„Éô„É≠' }
        };

        // ÂêÑ„É≠„Éº„ÉÜ„Éº„Ç∑„Éß„É≥„Åß„ÅÆ„Éù„Ç∏„Ç∑„Éß„É≥ÈÖçÁΩÆÔºà‚ë†‚ë°‚ë¢‚ë£‚ë§‚ë•„ÅÆÈ†ÜÔºâ
        const rotations = {
            1: ['„Åü„ÅÑ', '„Åø„Åè', '„Åü„Åë„Å°„ÇÉ„Çì', '„Çµ„Ç§„É§', '„ÇÜ„Åç', '„Åè„Å´„Åø„Å§'],
            2: ['„Åè„Å´„Åø„Å§', '„Åü„ÅÑ', '„Åø„Åè', '„Åü„Åë„Å°„ÇÉ„Çì', '„Çµ„Ç§„É§', '„ÇÜ„Åç'],
            3: ['„ÇÜ„Åç', '„Åè„Å´„Åø„Å§', '„Åü„ÅÑ', '„Åø„Åè', '„Åü„Åë„Å°„ÇÉ„Çì', '„Çµ„Ç§„É§'],
            4: ['„Çµ„Ç§„É§', '„ÇÜ„Åç', '„Åè„Å´„Åø„Å§', '„Åü„ÅÑ', '„Åø„Åè', '„Åü„Åë„Å°„ÇÉ„Çì'],
            5: ['„Åü„Åë„Å°„ÇÉ„Çì', '„Çµ„Ç§„É§', '„ÇÜ„Åç', '„Åè„Å´„Åø„Å§', '„Åü„ÅÑ', '„Åø„Åè'],
            6: ['„Åø„Åè', '„Åü„Åë„Å°„ÇÉ„Çì', '„Çµ„Ç§„É§', '„ÇÜ„Åç', '„Åè„Å´„Åø„Å§', '„Åü„ÅÑ']
        };

        // Ëá™Èô£„Ç≥„Éº„Éà„Åß„ÅÆ„Éù„Ç∏„Ç∑„Éß„É≥Â∫ßÊ®ôÔºà%Ôºâ
        const positions = [
            { x: 80, y: 75, label: '‚ë†' },  // „Éù„Ç∏„Ç∑„Éß„É≥1ÔºàÂæåË°õÂè≥Ôºâ
            { x: 80, y: 25, label: '‚ë°' },  // „Éù„Ç∏„Ç∑„Éß„É≥2ÔºàÂâçË°õÂè≥Ôºâ
            { x: 50, y: 25, label: '‚ë¢' },  // „Éù„Ç∏„Ç∑„Éß„É≥3ÔºàÂâçË°õ‰∏≠Â§ÆÔºâ
            { x: 20, y: 25, label: '‚ë£' },  // „Éù„Ç∏„Ç∑„Éß„É≥4ÔºàÂâçË°õÂ∑¶Ôºâ
            { x: 20, y: 75, label: '‚ë§' },  // „Éù„Ç∏„Ç∑„Éß„É≥5ÔºàÂæåË°õÂ∑¶Ôºâ
            { x: 50, y: 75, label: '‚ë•' }   // „Éù„Ç∏„Ç∑„Éß„É≥6ÔºàÂæåË°õ‰∏≠Â§ÆÔºâ
        ];

        function showSlide(slideNum) {
            // ÂÖ®„Çπ„É©„Ç§„Éâ„ÇíÈùûË°®Á§∫
            document.querySelectorAll('.slide').forEach(slide => {
                slide.style.display = 'none';
            });

            // ÊåáÂÆö„Åï„Çå„Åü„Çπ„É©„Ç§„Éâ„ÇíË°®Á§∫
            const targetSlide = document.getElementById(`slide${slideNum}`);
            if (targetSlide) {
                targetSlide.style.display = 'block';
            }

            // „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥Êõ¥Êñ∞
            document.getElementById('slideCounter').textContent = `${slideNum} / ${totalSlides}`;
            document.getElementById('prevBtn').disabled = slideNum === 1;
            document.getElementById('nextBtn').disabled = slideNum === totalSlides;

            currentSlide = slideNum;
        }

        function nextSlide() {
            if (currentSlide < totalSlides) {
                showSlide(currentSlide + 1);
            }
        }

        function prevSlide() {
            if (currentSlide > 1) {
                showSlide(currentSlide - 1);
            }
        }

        function createRotationSlides() {
            const slideContainer = document.body;

            // ÂêÑ„É≠„Éº„ÉÜ„Éº„Ç∑„Éß„É≥„ÅÆ„Çµ„Éº„Éñ„É¨„Ç∑„Éº„Éñ„Å®„Çπ„Éë„Ç§„ÇØ„É¨„Ç∑„Éº„Éñ„Çí‰ΩúÊàê
            for (let rotation = 1; rotation <= 6; rotation++) {
                // „Çµ„Éº„Éñ„É¨„Ç∑„Éº„Éñ„Çπ„É©„Ç§„Éâ
                const serveReceiveSlide = createServeReceiveSlide(rotation);
                slideContainer.insertBefore(serveReceiveSlide, document.querySelector('.navigation'));

                // „Çπ„Éë„Ç§„ÇØ„É¨„Ç∑„Éº„Éñ„Çπ„É©„Ç§„Éâ
                const spikeReceiveSlide = createSpikeReceiveSlide(rotation);
                slideContainer.insertBefore(spikeReceiveSlide, document.querySelector('.navigation'));
            }

            // „Åæ„Å®„ÇÅ„Çπ„É©„Ç§„Éâ
            const summarySlide = createSummarySlide();
            slideContainer.insertBefore(summarySlide, document.querySelector('.navigation'));

            // „Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„Éñ„Çπ„É©„Ç§„Éâ
            const interactiveSlide = createInteractiveSlide();
            slideContainer.insertBefore(interactiveSlide, document.querySelector('.navigation'));
        }

        // „Éâ„É©„ÉÉ„Ç∞Ê©üËÉΩ„ÅÆÂ§âÊï∞
        let isDragging = false;
        let currentDragElement = null;
        let startX = 0;
        let startY = 0;
        let offsetX = 0;
        let offsetY = 0;

        // „Éâ„É©„ÉÉ„Ç∞Ê©üËÉΩ„ÅÆÂàùÊúüÂåñ
        function initDragFunctionality() {
            const court = document.getElementById('interactiveCourt');
            if (!court) return;

            court.addEventListener('mousedown', handleStart);
            court.addEventListener('touchstart', handleStart, { passive: false });

            document.addEventListener('mousemove', handleMove);
            document.addEventListener('touchmove', handleMove, { passive: false });

            document.addEventListener('mouseup', handleEnd);
            document.addEventListener('touchend', handleEnd);
        }

        function handleStart(e) {
            e.preventDefault();
            const target = e.target;

            if (target.classList.contains('draggable')) {
                isDragging = true;
                currentDragElement = target;
                target.classList.add('dragging');

                const clientX = e.type === 'mousedown' ? e.clientX : e.touches[0].clientX;
                const clientY = e.type === 'mousedown' ? e.clientY : e.touches[0].clientY;

                const rect = target.getBoundingClientRect();
                offsetX = clientX - rect.left - rect.width / 2;
                offsetY = clientY - rect.top - rect.height / 2;

                startX = clientX;
                startY = clientY;
            }
        }

        function handleMove(e) {
            if (!isDragging || !currentDragElement) return;

            e.preventDefault();

            const clientX = e.type === 'mousemove' ? e.clientX : e.touches[0].clientX;
            const clientY = e.type === 'mousemove' ? e.clientY : e.touches[0].clientY;

            const court = document.getElementById('interactiveCourt');
            const courtRect = court.getBoundingClientRect();

            // „Ç≥„Éº„ÉàÂÜÖ„Åß„ÅÆÁõ∏ÂØæ‰ΩçÁΩÆ„ÇíË®àÁÆó
            const relativeX = clientX - courtRect.left - offsetX;
            const relativeY = clientY - courtRect.top - offsetY;

            // „Éë„Éº„Çª„É≥„ÉÜ„Éº„Ç∏„Å´Â§âÊèõÔºà„Ç≥„Éº„ÉàÂ¢ÉÁïåÂÜÖ„Å´Âà∂ÈôêÔºâ
            const percentX = Math.max(5, Math.min(95, (relativeX / courtRect.width) * 100));
            const percentY = Math.max(5, Math.min(95, (relativeY / courtRect.height) * 100));

            currentDragElement.style.left = percentX + '%';
            currentDragElement.style.top = percentY + '%';
        }

        function handleEnd(e) {
            if (isDragging && currentDragElement) {
                currentDragElement.classList.remove('dragging');
                currentDragElement = null;
                isDragging = false;
            }
        }

        // „Éó„É™„Çª„ÉÉ„ÉàÈÖçÁΩÆÈñ¢Êï∞
        function resetToBasic() {
            const players = [
                { id: 'player-„Çµ„Ç§„É§', x: 20, y: 25 },
                { id: 'player-„Åü„Åë„Å°„ÇÉ„Çì', x: 50, y: 25 },
                { id: 'player-„Åø„Åè', x: 80, y: 25 },
                { id: 'player-„ÇÜ„Åç', x: 20, y: 75 },
                { id: 'player-„Åè„Å´„Åø„Å§', x: 50, y: 75 },
                { id: 'player-„Åü„ÅÑ', x: 80, y: 75 }
            ];

            players.forEach(player => {
                const element = document.getElementById(player.id);
                if (element) {
                    element.style.left = player.x + '%';
                    element.style.top = player.y + '%';
                }
            });
        }

        function resetToServeReceive() {
            const players = [
                { id: 'player-„Çµ„Ç§„É§', x: 25, y: 25 },
                { id: 'player-„Åü„Åë„Å°„ÇÉ„Çì', x: 50, y: 20 },
                { id: 'player-„Åø„Åè', x: 75, y: 25 },
                { id: 'player-„ÇÜ„Åç', x: 30, y: 65 },
                { id: 'player-„Åè„Å´„Åø„Å§', x: 50, y: 80 },
                { id: 'player-„Åü„ÅÑ', x: 70, y: 65 }
            ];

            players.forEach(player => {
                const element = document.getElementById(player.id);
                if (element) {
                    element.style.left = player.x + '%';
                    element.style.top = player.y + '%';
                }
            });
        }

        function resetToSpikeReceive() {
            const players = [
                { id: 'player-„Çµ„Ç§„É§', x: 55, y: 8 },
                { id: 'player-„Åü„Åë„Å°„ÇÉ„Çì', x: 40, y: 28 },
                { id: 'player-„Åø„Åè', x: 70, y: 8 },
                { id: 'player-„ÇÜ„Åç', x: 15, y: 70 },
                { id: 'player-„Åè„Å´„Åø„Å§', x: 85, y: 70 },
                { id: 'player-„Åü„ÅÑ', x: 50, y: 85 }
            ];

            players.forEach(player => {
                const element = document.getElementById(player.id);
                if (element) {
                    element.style.left = player.x + '%';
                    element.style.top = player.y + '%';
                }
            });
        }

        function createServeReceiveSlide(rotationNum) {
            const slide = document.createElement('div');
            slide.className = 'slide';
            slide.id = `slide${rotationNum * 2}`;
            slide.style.display = 'none';

            const currentPlayers = rotations[rotationNum];
            const setterPosition = currentPlayers.indexOf('„Åü„Åë„Å°„ÇÉ„Çì') + 1;
            const isSetterFront = setterPosition <= 3;

            slide.innerHTML = `
                <div class="slide-header">
                    <div class="slide-number">${rotationNum * 2}</div>
                    <h2 class="slide-title">„É≠„Éº„ÉÜ„Éº„Ç∑„Éß„É≥ ${rotationNum}<br>„Çµ„Éº„Éñ„É¨„Ç∑„Éº„Éñ</h2>
                    <p class="slide-subtitle">WÂûã„Éï„Ç©„Éº„É°„Éº„Ç∑„Éß„É≥</p>
                </div>

                <div class="court">
                    <div class="net-label">„Éç„ÉÉ„ÉàÔºàÁõ∏Êâã„Çµ„Éº„ÉñÔºâ</div>
                    <div class="front-zone">
                        <div class="front-label">ÂâçË°õ</div>
                    </div>
                    <div class="back-label">ÂæåË°õ</div>
                    ${createServeReceiveHTML(currentPlayers)}
                </div>

                <div class="explanation">
                    <h3>üéØ „Çµ„Éº„Éñ„É¨„Ç∑„Éº„Éñ‰ΩìÂà∂</h3>
                    <p>ÂæåË°õ3‰∫∫„ÅßWÂûã„Çí‰Ωú„ÇäÁ¢∫ÂÆü„Å´„É¨„Ç∑„Éº„Éñ„ÄÇ„Çª„ÉÉ„Çø„ÉºÔºà„Åü„Åë„Å°„ÇÉ„ÇìÔºâ„ÅØ„Éç„ÉÉ„ÉàÈöõ„Å∏ÁßªÂãïÊ∫ñÂÇô„ÄÅÂâçË°õ„ÅØÊîªÊíÉÊ∫ñÂÇô„ÄÇ</p>
                </div>

                <div class="key-points">
                    <h4>üìã ÂΩπÂâ≤ÂàÜÊãÖ</h4>
                    <ul>
                        ${createServeReceiveRoles(currentPlayers)}
                    </ul>
                </div>
            `;

            return slide;
        }

        function createSpikeReceiveSlide(rotationNum) {
            const slide = document.createElement('div');
            slide.className = 'slide';
            slide.id = `slide${rotationNum * 2 + 1}`;
            slide.style.display = 'none';

            const currentPlayers = rotations[rotationNum];

            slide.innerHTML = `
                <div class="slide-header">
                    <div class="slide-number">${rotationNum * 2 + 1}</div>
                    <h2 class="slide-title">„É≠„Éº„ÉÜ„Éº„Ç∑„Éß„É≥ ${rotationNum}<br>„Çπ„Éë„Ç§„ÇØ„É¨„Ç∑„Éº„Éñ</h2>
                    <p class="slide-subtitle">„Éñ„É≠„ÉÉ„ÇØ„ÉªÂÆàÂÇô‰ΩìÂà∂</p>
                </div>

                <div class="court">
                    <div class="net-label">„Éç„ÉÉ„ÉàÔºàÁõ∏ÊâãÊîªÊíÉÔºâ</div>
                    <div class="front-zone">
                        <div class="front-label">ÂâçË°õÔºà„Éñ„É≠„ÉÉ„ÇØÔºâ</div>
                    </div>
                    <div class="back-label">ÂæåË°õÔºà„É¨„Ç∑„Éº„ÉñÔºâ</div>
                    ${createSpikeReceiveHTML(currentPlayers)}
                </div>

                <div class="explanation">
                    <h3>üõ°Ô∏è „Çπ„Éë„Ç§„ÇØ„É¨„Ç∑„Éº„Éñ‰ΩìÂà∂</h3>
                    <p>Áõ∏Êâã„É¨„Éï„Éà„Åã„Çâ„ÅÆÊîªÊíÉ„Å´ÂØæÂøú„ÄÇ„Éñ„É≠„ÉÉ„ÇØ2‰∫∫„ÅåÂè≥ÂÅ¥„Å´ÈõÜ‰∏≠„ÄÅÂæåË°õ„ÅØÊîªÊíÉ„Ç≥„Éº„Çπ„Çí„Ç´„Éê„Éº„Åô„ÇãÈÖçÁΩÆ„ÅßÂÆàÂÇô„ÄÇ</p>
                </div>

                <div class="key-points">
                    <h4>üìã ÂÆàÂÇôÊôÇ„ÅÆÂãï„Åç</h4>
                    <ul>
                        ${createSpikeReceiveRoles(currentPlayers)}
                    </ul>
                </div>
            `;

            return slide;
        }

        function createServeReceiveHTML(currentPlayers) {
            // „Çµ„Éº„Éñ„É¨„Ç∑„Éº„ÉñÊôÇ„ÅÆÈÖçÁΩÆÔºàWÂûãÔºâ
            let html = '';

            try {
                const serveReceivePositions = getServeReceivePositions(currentPlayers);

                currentPlayers.forEach((playerName, index) => {
                    const playerInfo = players[playerName];
                    const shortName = playerName === '„Åü„Åë„Å°„ÇÉ„Çì' ? '„Åü„Åë' :
                        playerName === '„Åè„Å´„Åø„Å§' ? '„Åè„Å´' : playerName;
                    const genderClass = playerInfo.gender === 'male' ? 'male' : 'female';
                    const setterClass = playerName === '„Åü„Åë„Å°„ÇÉ„Çì' ? ' setter' : '';

                    // ‰ΩçÁΩÆÊÉÖÂ†±„Åå„ÅÇ„Çã„Åã„ÉÅ„Çß„ÉÉ„ÇØ
                    const pos = serveReceivePositions[playerName];
                    if (pos && pos.x !== undefined && pos.y !== undefined) {
                        html += `
                            <div class="player ${genderClass}${setterClass}" style="left: ${pos.x}%; top: ${pos.y}%;">${shortName}</div>
                        `;
                    } else {
                        // „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ: Âü∫Êú¨„É≠„Éº„ÉÜ„Éº„Ç∑„Éß„É≥‰ΩçÁΩÆ
                        html += `
                            <div class="player ${genderClass}${setterClass}" style="left: ${positions[index].x}%; top: ${positions[index].y}%;">${shortName}</div>
                        `;
                    }
                });
            } catch (error) {
                console.error('Error in createServeReceiveHTML:', error);
                // „Ç®„É©„ÉºÊôÇ„ÅØÂü∫Êú¨„É≠„Éº„ÉÜ„Éº„Ç∑„Éß„É≥‰ΩçÁΩÆ„ÅßË°®Á§∫
                currentPlayers.forEach((playerName, index) => {
                    const playerInfo = players[playerName];
                    const shortName = playerName === '„Åü„Åë„Å°„ÇÉ„Çì' ? '„Åü„Åë' :
                        playerName === '„Åè„Å´„Åø„Å§' ? '„Åè„Å´' : playerName;
                    const genderClass = playerInfo.gender === 'male' ? 'male' : 'female';
                    const setterClass = playerName === '„Åü„Åë„Å°„ÇÉ„Çì' ? ' setter' : '';

                    html += `
                        <div class="player ${genderClass}${setterClass}" style="left: ${positions[index].x}%; top: ${positions[index].y}%;">${shortName}</div>
                    `;
                });
            }

            return html;
        }

        function createSpikeReceiveHTML(currentPlayers) {
            // „Çπ„Éë„Ç§„ÇØ„É¨„Ç∑„Éº„ÉñÊôÇ„ÅÆÊà¶Ë°ìÁöÑÈÖçÁΩÆ
            const spikeReceivePositions = getSpikeReceivePositions(currentPlayers);
            let html = '';

            currentPlayers.forEach((playerName, index) => {
                const playerInfo = players[playerName];
                const shortName = playerName === '„Åü„Åë„Å°„ÇÉ„Çì' ? '„Åü„Åë' :
                    playerName === '„Åè„Å´„Åø„Å§' ? '„Åè„Å´' : playerName;
                const genderClass = playerInfo.gender === 'male' ? 'male' : 'female';
                const setterClass = playerName === '„Åü„Åë„Å°„ÇÉ„Çì' ? ' setter' : '';

                // Êà¶Ë°ìÁöÑ‰ΩçÁΩÆ„Åå„ÅÇ„Çã„Åã„ÉÅ„Çß„ÉÉ„ÇØ
                const pos = spikeReceivePositions[playerName];
                if (pos) {
                    html += `
                        <div class="player ${genderClass}${setterClass}" style="left: ${pos.x}%; top: ${pos.y}%;">${shortName}</div>
                    `;
                } else {
                    // „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ: Âü∫Êú¨„É≠„Éº„ÉÜ„Éº„Ç∑„Éß„É≥‰ΩçÁΩÆ
                    html += `
                        <div class="player ${genderClass}${setterClass}" style="left: ${positions[index].x}%; top: ${positions[index].y}%;">${shortName}</div>
                    `;
                }
            });

            return html;
        }

        function getSpikeReceivePositions(currentPlayers) {
            const positions = {};

            const setterPosition = currentPlayers.indexOf('„Åü„Åë„Å°„ÇÉ„Çì') + 1;
            const isSetterFront = setterPosition <= 3;

            // ÂâçË°õ„Å®ÂæåË°õ„ÇíÂàÜ„Åë„Çã
            const frontPlayers = [];
            const backPlayers = [];

            currentPlayers.forEach((playerName, index) => {
                if (index === 1 || index === 2 || index === 3) {
                    frontPlayers.push(playerName);
                } else {
                    backPlayers.push(playerName);
                }
            });

            // ÂâçË°õ„ÅÆ„Éñ„É≠„ÉÉ„ÇØ„Éª„Ç´„Éê„ÉºÈÖçÁΩÆ
            if (isSetterFront) {
                // „Åü„Åë„Å°„ÇÉ„Çì„ÅåÂâçË°õ„ÅÆÊôÇ: ‰ªñÂ•≥ÊÄß1 + Áî∑ÊÄß1„Åß„Éñ„É≠„ÉÉ„ÇØ„ÄÅ„Åü„Åë„Å°„ÇÉ„Çì„Åå„Ç´„Éê„Éº
                const otherFrontPlayers = frontPlayers.filter(name => name !== '„Åü„Åë„Å°„ÇÉ„Çì');
                const frontFemale = otherFrontPlayers.find(name => players[name].gender === 'female');
                const frontMale = otherFrontPlayers.find(name => players[name].gender === 'male');

                // Áõ∏Êâã„É¨„Éï„ÉàÊîªÊíÉ„Å´ÂØæ„Åô„Çã„Éñ„É≠„ÉÉ„ÇØÔºà„ÇØ„É≠„Çπ„ÇíÈñâ„ÇÅ„ÇãÔºâ
                if (frontFemale) positions[frontFemale] = { x: 55, y: 8 };
                if (frontMale) positions[frontMale] = { x: 70, y: 8 };

                // „Ç´„Éê„ÉºÔºà„Åü„Åë„Å°„ÇÉ„ÇìÔºâ
                positions['„Åü„Åë„Å°„ÇÉ„Çì'] = { x: 40, y: 28 };

            } else {
                // „Åü„Åë„Å°„ÇÉ„Çì„ÅåÂæåË°õ„ÅÆÊôÇ: Áî∑ÊÄß2‰∫∫„Åß„Éñ„É≠„ÉÉ„ÇØ„ÄÅÂ•≥ÊÄß1‰∫∫„Åå„Ç´„Éê„Éº
                const frontMales = frontPlayers.filter(name => players[name].gender === 'male');
                const frontFemale = frontPlayers.find(name => players[name].gender === 'female');

                // Áõ∏Êâã„É¨„Éï„ÉàÊîªÊíÉ„Å´ÂØæ„Åô„Çã„Éñ„É≠„ÉÉ„ÇØÔºà„ÇØ„É≠„Çπ„ÇíÈñâ„ÇÅ„ÇãÔºâ
                if (frontMales[0]) positions[frontMales[0]] = { x: 55, y: 8 };
                if (frontMales[1]) positions[frontMales[1]] = { x: 70, y: 8 };

                // „Ç´„Éê„ÉºÔºàÂâçË°õÂ•≥ÊÄßÔºâ
                if (frontFemale) positions[frontFemale] = { x: 40, y: 28 };
            }

            // ÂæåË°õ„ÅÆÊà¶Ë°ìÁöÑÈÖçÁΩÆÔºàÁõ∏Êâã„É¨„Éï„ÉàÊîªÊíÉÂØæÂøúÔºâ
            backPlayers.forEach(playerName => {
                if (playerName === '„Åü„Åë„Å°„ÇÉ„Çì' || playerName === '„Åè„Å´„Åø„Å§') {
                    // „Çπ„Éà„É¨„Éº„ÉàÂÆàÂÇôÔºàÂè≥ÂÅ¥Ôºâ
                    positions[playerName] = { x: 85, y: 70 };
                } else if (playerName === '„Åø„Åè' || playerName === '„ÇÜ„Åç') {
                    // „Çª„É≥„Çø„ÉºÂÆàÂÇôÔºàÁúü„Çì‰∏≠Ôºâ
                    positions[playerName] = { x: 50, y: 85 };
                } else if (playerName === '„Åü„ÅÑ' || playerName === '„Çµ„Ç§„É§') {
                    // „ÇØ„É≠„ÇπÂÆàÂÇôÔºàÂ∑¶ÂÅ¥Ôºâ
                    positions[playerName] = { x: 15, y: 70 };
                }
            });

            return positions;
        }

        function getServeReceivePositions(currentPlayers) {
            const positions = {};
            const setterPosition = currentPlayers.indexOf('„Åü„Åë„Å°„ÇÉ„Çì') + 1;
            const isSetterFront = setterPosition <= 3;

            // ÂâçË°õ„Å®ÂæåË°õ„ÇíÂàÜ„Åë„Çã
            const frontPlayers = [];
            const backPlayers = [];

            currentPlayers.forEach((playerName, index) => {
                if (index === 1 || index === 2 || index === 3) {
                    frontPlayers.push(playerName);
                } else {
                    backPlayers.push(playerName);
                }
            });

            if (isSetterFront) {
                // „Çª„ÉÉ„Çø„Éº„ÅåÂâçË°õ„ÅÆÊôÇÔºö„Çª„ÉÉ„Çø„Éº„ÅØ„Éç„ÉÉ„ÉàÈöõ„Å∏ÁßªÂãï„ÄÅ‰ªñ„ÅÆÂâçË°õ2‰∫∫„ÅØÊîªÊíÉÊ∫ñÂÇô
                positions['„Åü„Åë„Å°„ÇÉ„Çì'] = { x: 50, y: 20 };

                // ÂâçË°õ„ÅÆ‰ªñ„ÅÆ2‰∫∫„ÅØÂ∑¶Âè≥„Å´ÂàÜ„Åã„Çå„Å¶ÊîªÊíÉÊ∫ñÂÇô
                const otherFrontPlayers = frontPlayers.filter(name => name !== '„Åü„Åë„Å°„ÇÉ„Çì');
                if (otherFrontPlayers.length >= 1) positions[otherFrontPlayers[0]] = { x: 25, y: 25 };
                if (otherFrontPlayers.length >= 2) positions[otherFrontPlayers[1]] = { x: 75, y: 25 };

                // ÂæåË°õ3‰∫∫„ÅßWÂûã„É¨„Ç∑„Éº„Éñ
                if (backPlayers.length >= 1) positions[backPlayers[0]] = { x: 70, y: 65 };  // Âè≥
                if (backPlayers.length >= 2) positions[backPlayers[1]] = { x: 30, y: 65 };  // Â∑¶
                if (backPlayers.length >= 3) positions[backPlayers[2]] = { x: 50, y: 80 };  // ‰∏≠Â§ÆÂæå

            } else {
                // „Çª„ÉÉ„Çø„Éº„ÅåÂæåË°õ„ÅÆÊôÇÔºöÂæåË°õ„Åß„É¨„Ç∑„Éº„ÉñÂèÇÂä†„ÄÅÂâçË°õ„ÅØÊîªÊíÉÊ∫ñÂÇô
                // ÂâçË°õ3‰∫∫„ÅØÊîªÊíÉÊ∫ñÂÇô
                if (frontPlayers.length >= 1) positions[frontPlayers[0]] = { x: 20, y: 25 };
                if (frontPlayers.length >= 2) positions[frontPlayers[1]] = { x: 50, y: 20 };
                if (frontPlayers.length >= 3) positions[frontPlayers[2]] = { x: 80, y: 25 };

                // ÂæåË°õ„Åß„ÅÆ„É¨„Ç∑„Éº„ÉñÈÖçÁΩÆÔºà„Çª„ÉÉ„Çø„Éº„ÅÆ‰ΩçÁΩÆ„Å´„Çà„ÇäË™øÊï¥Ôºâ
                if (setterPosition === 1) {
                    // „Çª„ÉÉ„Çø„Éº„ÅåÂæåË°õÂè≥„ÅÆÂ†¥Âêà
                    positions['„Åü„Åë„Å°„ÇÉ„Çì'] = { x: 65, y: 70 };
                    const otherBackPlayers = backPlayers.filter(name => name !== '„Åü„Åë„Å°„ÇÉ„Çì');
                    if (otherBackPlayers.length >= 1) positions[otherBackPlayers[0]] = { x: 35, y: 65 };
                    if (otherBackPlayers.length >= 2) positions[otherBackPlayers[1]] = { x: 50, y: 85 };
                } else if (setterPosition === 5) {
                    // „Çª„ÉÉ„Çø„Éº„ÅåÂæåË°õÂ∑¶„ÅÆÂ†¥Âêà
                    positions['„Åü„Åë„Å°„ÇÉ„Çì'] = { x: 35, y: 70 };
                    const otherBackPlayers = backPlayers.filter(name => name !== '„Åü„Åë„Å°„ÇÉ„Çì');
                    if (otherBackPlayers.length >= 1) positions[otherBackPlayers[0]] = { x: 65, y: 65 };
                    if (otherBackPlayers.length >= 2) positions[otherBackPlayers[1]] = { x: 50, y: 85 };
                } else {
                    // „Çª„ÉÉ„Çø„Éº„ÅåÂæåË°õ‰∏≠Â§Æ„ÅÆÂ†¥Âêà
                    positions['„Åü„Åë„Å°„ÇÉ„Çì'] = { x: 50, y: 75 };
                    const otherBackPlayers = backPlayers.filter(name => name !== '„Åü„Åë„Å°„ÇÉ„Çì');
                    if (otherBackPlayers.length >= 1) positions[otherBackPlayers[0]] = { x: 30, y: 65 };
                    if (otherBackPlayers.length >= 2) positions[otherBackPlayers[1]] = { x: 70, y: 65 };
                }
            }

            return positions;
        }

        function createServeReceiveRoles(currentPlayers) {
            let html = '';
            const setterPosition = currentPlayers.indexOf('„Åü„Åë„Å°„ÇÉ„Çì') + 1;
            const isSetterFront = setterPosition <= 3;

            if (isSetterFront) {
                html += '<li><strong>„Åü„Åë„Å°„ÇÉ„ÇìÔºö</strong>„Éç„ÉÉ„ÉàÈöõÁßªÂãï„Éª„Çª„ÉÉ„ÉàÊ∫ñÂÇô</li>';
            } else {
                html += '<li><strong>„Åü„Åë„Å°„ÇÉ„ÇìÔºö</strong>„Çµ„Éº„Éñ„É¨„Ç∑„Éº„Éñ„Éª„Çª„ÉÉ„ÉàÊ∫ñÂÇô</li>';
            }

            currentPlayers.forEach((playerName, index) => {
                if (playerName !== '„Åü„Åë„Å°„ÇÉ„Çì') {
                    const isBack = index === 0 || index === 4 || index === 5;
                    const role = isBack ? '„Çµ„Éº„Éñ„É¨„Ç∑„Éº„ÉñÔºàWÂûãÔºâ' : '„Ç¢„Çø„ÉÉ„ÇØÊ∫ñÂÇô';
                    html += `<li><strong>${playerName}Ôºö</strong>${role}</li>`;
                }
            });

            return html;
        }

        function createSpikeReceiveRoles(currentPlayers) {
            let html = '';
            const setterPosition = currentPlayers.indexOf('„Åü„Åë„Å°„ÇÉ„Çì') + 1;
            const isSetterFront = setterPosition <= 3;

            // ÂâçË°õ„Å®ÂæåË°õ„ÇíÂàÜ„Åë„Çã
            const frontPlayers = [];
            const backPlayers = [];

            currentPlayers.forEach((playerName, index) => {
                if (index === 1 || index === 2 || index === 3) {
                    frontPlayers.push(playerName);
                } else {
                    backPlayers.push(playerName);
                }
            });

            // ÂâçË°õ„ÅÆÂΩπÂâ≤
            if (isSetterFront) {
                html += '<li><strong>„Åü„Åë„Å°„ÇÉ„ÇìÔºö</strong>ÂâçË°õ„Ç´„Éê„Éº„Éª„Çª„ÉÉ„Çø„ÉºÊ∫ñÂÇô</li>';

                const otherFrontPlayers = frontPlayers.filter(name => name !== '„Åü„Åë„Å°„ÇÉ„Çì');
                otherFrontPlayers.forEach(playerName => {
                    html += `<li><strong>${playerName}Ôºö</strong>„Éñ„É≠„ÉÉ„ÇØÔºà„ÇØ„É≠„ÇπÈñâ„ÇÅÔºâ</li>`;
                });

            } else {
                const frontMales = frontPlayers.filter(name => players[name].gender === 'male');
                const frontFemale = frontPlayers.find(name => players[name].gender === 'female');

                frontMales.forEach(playerName => {
                    html += `<li><strong>${playerName}Ôºö</strong>„Éñ„É≠„ÉÉ„ÇØÔºà„ÇØ„É≠„ÇπÈñâ„ÇÅÔºâ</li>`;
                });

                if (frontFemale) {
                    html += `<li><strong>${frontFemale}Ôºö</strong>ÂâçË°õ„Ç´„Éê„Éº</li>`;
                }
            }

            // ÂæåË°õ„ÅÆÊà¶Ë°ìÁöÑÂΩπÂâ≤ÔºàÁõ∏Êâã„É¨„Éï„ÉàÊîªÊíÉÂØæÂøúÔºâ
            backPlayers.forEach(playerName => {
                if (playerName === '„Åü„Åë„Å°„ÇÉ„Çì' || playerName === '„Åè„Å´„Åø„Å§') {
                    html += `<li><strong>${playerName}Ôºö</strong>„Çπ„Éà„É¨„Éº„ÉàÂÆàÂÇôÔºàÂè≥ÂÅ¥Ôºâ</li>`;
                } else if (playerName === '„Åø„Åè' || playerName === '„ÇÜ„Åç') {
                    html += `<li><strong>${playerName}Ôºö</strong>„Çª„É≥„Çø„ÉºÂÆàÂÇôÔºàÁúü„Çì‰∏≠Ôºâ</li>`;
                } else if (playerName === '„Åü„ÅÑ' || playerName === '„Çµ„Ç§„É§') {
                    html += `<li><strong>${playerName}Ôºö</strong>„ÇØ„É≠„ÇπÂÆàÂÇôÔºàÂ∑¶ÂÅ¥Ôºâ</li>`;
                }
            });

            return html;
        }

        function createSummarySlide() {
            const slide = document.createElement('div');
            slide.className = 'slide';
            slide.id = 'slide14';
            slide.style.display = 'none';
            slide.innerHTML = `
                <div class="slide-header">
                    <div class="slide-number">14</div>
                    <h2 class="slide-title">„Åæ„Å®„ÇÅ„ÉªÊ≥®ÊÑèÁÇπ</h2>
                    <p class="slide-subtitle">Á∑¥Áøí„ÅßÊÑèË≠ò„Åô„Çã„Åì„Å®</p>
                </div>

                <div class="key-points">
                    <h4>üéØ Á∑¥Áøí„ÅÆ„Éù„Ç§„É≥„Éà</h4>
                    <ul>
                        <li><strong>„É≠„Éº„ÉÜ„Éº„Ç∑„Éß„É≥Ôºö</strong>„Çµ„Éº„ÉñÂæå„ÅØÂøÖ„ÅöÊôÇË®àÂõû„Çä</li>
                        <li><strong>„Çµ„Éº„Éñ„É¨„Ç∑„Éº„ÉñÔºö</strong>WÂûã„Éï„Ç©„Éº„É°„Éº„Ç∑„Éß„É≥„ÇíÂæπÂ∫ï</li>
                        <li><strong>„Çπ„Éë„Ç§„ÇØ„É¨„Ç∑„Éº„ÉñÔºö</strong>ÂâçË°õ„Éñ„É≠„ÉÉ„ÇØ„ÉªÂæåË°õ„É¨„Ç∑„Éº„Éñ</li>
                        <li><strong>„Çª„ÉÉ„Çø„ÉºÔºö</strong>„Åü„Åë„Å°„ÇÉ„Çì„ÅÆÂãï„Åç„ÇíÂÖ®Âì°„ÅßÊääÊè°</li>
                    </ul>
                </div>

                <div class="rule-section">
                    <h4>‚ö†Ô∏è „Çà„Åè„ÅÇ„ÇãÈñìÈÅï„ÅÑ</h4>
                    <div style="font-size: 12px; line-height: 1.5;">
                        <p>‚Ä¢ „É≠„Éº„ÉÜ„Éº„Ç∑„Éß„É≥Âøò„ÇåÔºàÁâπ„Å´„Çµ„Éº„ÉñÂæåÔºâ<br>
                        ‚Ä¢ „Çµ„Éº„Éñ„É¨„Ç∑„Éº„ÉñÊôÇ„ÅÆWÂûãÂ¥©„Çå<br>
                        ‚Ä¢ ÂâçË°õ„ÉªÂæåË°õ„ÅÆÂΩπÂâ≤Ê∑∑Âêå<br>
                        ‚Ä¢ „Çª„ÉÉ„Çø„Éº„ÅÆ‰ΩçÁΩÆÁ¢∫Ë™ç‰∏çË∂≥</p>
                    </div>
                </div>

                <div class="rule-section">
                    <h4>üì± „Åì„ÅÆ„Éï„Ç©„Éº„É°„Éº„Ç∑„Éß„É≥Ë°®„ÅÆ‰Ωø„ÅÑÊñπ</h4>
                    <div style="font-size: 12px; line-height: 1.5;">
                        <p>‚Ä¢ Á∑¥ÁøíÂâç„Å´„ÉÅ„Éº„É†ÂÖ®Âì°„ÅßÁ¢∫Ë™ç<br>
                        ‚Ä¢ Ë©¶Âêà‰∏≠„ÅÆ„Çø„Ç§„É†„Ç¢„Ç¶„ÉàÊôÇ„Å´ÂèÇÁÖß<br>
                        ‚Ä¢ Êñ∞„É°„É≥„Éê„Éº„Å∏„ÅÆË™¨ÊòéË≥áÊñô„Å®„Åó„Å¶Ê¥ªÁî®<br>
                        ‚Ä¢ Ëá™‰∏ªÁ∑¥ÁøíÊôÇ„ÅÆ„Éù„Ç∏„Ç∑„Éß„É≥Á¢∫Ë™ç</p>
                    </div>
                </div>

                <div class="explanation">
                    <h3>üî• „ÉÅ„Éº„É†ÂäõÂêë‰∏ä„ÅÆ„Åü„ÇÅ„Å´</h3>
                    <p>ÂêÑ„É≠„Éº„ÉÜ„Éº„Ç∑„Éß„É≥„Åß„ÅÆ<strong>„Çµ„Éº„Éñ„É¨„Ç∑„Éº„Éñ</strong>„Å®<strong>„Çπ„Éë„Ç§„ÇØ„É¨„Ç∑„Éº„Éñ</strong>„ÅÆÈÅï„ÅÑ„ÇíÊÑèË≠ò„Åó„Å¶„ÄÅÁä∂Ê≥Å„Å´Âøú„Åò„ÅüÊ≠£Á¢∫„Å™„Éù„Ç∏„Ç∑„Éß„Éã„É≥„Ç∞„ÇíÂøÉ„Åå„Åë„Åæ„Åó„Çá„ÅÜÔºÅ</p>
                </div>

                <div style="text-align: center; margin-top: 20px; padding: 15px; background: linear-gradient(45deg, #43e97b, #38f9d7); border-radius: 12px; color: white;">
                    <h3 style="margin: 0 0 8px 0; font-size: 16px;">üèê È†ëÂºµ„Çç„ÅÜÔºÅ</h3>
                    <p style="margin: 0; font-size: 13px;">Ê¨°„ÅØ„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„ÉñÁ∑¥Áøí„Éö„Éº„Ç∏ ‚Üí</p>
                </div>
            `;

            return slide;
        }

        function createInteractiveSlide() {
            const slide = document.createElement('div');
            slide.className = 'slide';
            slide.id = 'slide15';
            slide.style.display = 'none';

            slide.innerHTML = `
                <div class="slide-header">
                    <div class="slide-number">15</div>
                    <h2 class="slide-title">üéÆ „Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„Éñ<br>„Éï„Ç©„Éº„É°„Éº„Ç∑„Éß„É≥Á∑¥Áøí</h2>
                    <p class="slide-subtitle">„Éó„É¨„Ç§„É§„Éº„Çí„Çø„ÉÉ„Éó„Åó„Å¶ÁßªÂãï„Åß„Åç„Åæ„Åô</p>
                </div>

                <div style="text-align: center; margin: 10px 0;">
                    <button class="nav-btn" onclick="resetToBasic()" style="margin: 5px;">Âü∫Êú¨ÈÖçÁΩÆ</button>
                    <button class="nav-btn" onclick="resetToServeReceive()" style="margin: 5px;">„Çµ„Éº„Éñ„É¨„Ç∑„Éº„Éñ</button>
                    <button class="nav-btn" onclick="resetToSpikeReceive()" style="margin: 5px;">„Çπ„Éë„Ç§„ÇØ„É¨„Ç∑„Éº„Éñ</button>
                </div>

                <div class="court" id="interactiveCourt" style="touch-action: none;">
                    <div class="net-label">„Éç„ÉÉ„Éà</div>
                    <div class="front-zone">
                        <div class="front-label">ÂâçË°õ</div>
                    </div>
                    <div class="back-label">ÂæåË°õ</div>
                    
                    <div class="player male draggable" id="player-„Çµ„Ç§„É§" style="left: 20%; top: 25%;">„Çµ„Ç§„É§</div>
                    <div class="player setter draggable" id="player-„Åü„Åë„Å°„ÇÉ„Çì" style="left: 50%; top: 25%;">„Åü„Åë</div>
                    <div class="player female draggable" id="player-„Åø„Åè" style="left: 80%; top: 25%;">„Åø„Åè</div>
                    <div class="player female draggable" id="player-„ÇÜ„Åç" style="left: 20%; top: 75%;">„ÇÜ„Åç</div>
                    <div class="player male draggable" id="player-„Åè„Å´„Åø„Å§" style="left: 50%; top: 75%;">„Åè„Å´</div>
                    <div class="player male draggable" id="player-„Åü„ÅÑ" style="left: 80%; top: 75%;">„Åü„ÅÑ</div>
                </div>

                <div class="explanation">
                    <h3>üéØ ‰Ωø„ÅÑÊñπ</h3>
                    <p>„Éó„É¨„Ç§„É§„Éº„Çí<strong>„Çø„ÉÉ„Éó&„Éâ„É©„ÉÉ„Ç∞</strong>„Åó„Å¶Ëá™Áî±„Å´ÈÖçÁΩÆÂ§âÊõ¥„Åß„Åç„Åæ„Åô„ÄÇ‰∏ä„ÅÆ„Éú„Çø„É≥„ÅßÂü∫Êú¨„Éï„Ç©„Éº„É°„Éº„Ç∑„Éß„É≥„Å´Êàª„Åõ„Åæ„Åô„ÄÇ</p>
                </div>

                <div class="key-points">
                    <h4>üí° Á∑¥Áøí„ÅÆ„Ç≥„ÉÑ</h4>
                    <ul>
                        <li>ÂÆüÈöõ„ÅÆË©¶Âêà„ÇíÊÉ≥ÂÆö„Åó„Å¶ÈÖçÁΩÆ„ÇíË©¶„Åó„Å¶„Åø„Çà„ÅÜ</li>
                        <li>„ÉÅ„Éº„É†„É°„É≥„Éê„Éº„Å®‰∏ÄÁ∑í„Å´ÊúÄÈÅ©„Å™ÈÖçÁΩÆ„ÇíËÄÉ„Åà„Çà„ÅÜ</li>
                        <li>Áõ∏Êâã„ÅÆÊîªÊíÉ„Éë„Çø„Éº„É≥„Å´Âøú„Åò„ÅüÂÆàÂÇô„ÇíÁ∑¥Áøí„Åó„Çà„ÅÜ</li>
                    </ul>
                </div>
            `;

            return slide;
        }

        // ÂàùÊúüÂåñ
        document.addEventListener('DOMContentLoaded', function () {
            createRotationSlides();
            showSlide(1);

            // „Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„ÉñÊ©üËÉΩ„ÅÆÂàùÊúüÂåñÔºàÂ∞ë„ÅóÈÅÖÂª∂„Åï„Åõ„ÇãÔºâ
            setTimeout(() => {
                initDragFunctionality();
            }, 500);
        });

        // „Ç≠„Éº„Éú„Éº„ÉâÊìç‰Ωú
        document.addEventListener('keydown', function (e) {
            if (e.key === 'ArrowLeft') prevSlide();
            if (e.key === 'ArrowRight') nextSlide();
        });
    </script>
</body>

</html>